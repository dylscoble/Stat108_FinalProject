---
title: "Stat108_FinalProject"
author: "Dylan Scoble and Aisha Lakshman"
date: "2/4/2022"
output: pdf_document
---


# Introduction

In the 2004 documentary Super Size Me, writer and director Morgan Spurlock took on a month-long challenge to only eat McDonalds food. Spurlock experienced a multitude of health issues, including weight gain, cholesterol spike, and negative impacts on his energy and mood, demonstrating the fast-food chains’ instrumental role in America’s obesity epidemic (Stossel 2006). Spurlock’s film not only emphasized the consequences of caloric intake, but also brought light to the nutritional attributes of McDonalds menu items that caused adverse health effects. There are many factors that impact the quality and quantity of calories, such as levels of fat, protein, and carbohydrates, which is why many dieticians support the notion that  “not all calories are created equal” (Tolar-Peterson, 2021). Spurlock’s documentary and existing literature inspired an investigation of McDonalds menu items’ caloric and nutritional records. Our research will address the following question: What nutritional attribute is the best predictor of calories for the McDonalds menu items? Since drink and food items have quite different caloric makeups, we are dividing our dataset between food menu items (Breakfast, Beef & Pork, Chicken & Fish, Salads, Snacks & Sides, Desserts) and drink menu items (Coffee and Tea, Smoothies and Shakes, Beverages). For food menu items, we hypothesize total carbohydrates (grams) is the most accurate predictor of calories. For drink menu items, we hypothesize that total sugar (grams) is the most accurate predictor of calories. We will analyze a 2018 dataset from Kaggle titled “Nutritional Facts for McDonald's Menu” to answer our research question. Our chosen dataset provides nutritional information for all of McDonald’s menu items, including calories, saturated fat, and cholesterol levels. We will create a linear model for each nutritional attribute with calories as the response variable for each predictor. A linear model for regression analysis is useful in answering our question because it will allow us to confidently determine what nutritional attributes matter the most for calories and predict an item’s calorie count based on its predictors.


### References

Tolar-Peterson, Terezie. 2021. “Not all calories are created equal - a dietician explains the different ways the kinds of foods you eat matter to your body”. The Conversation. Retrieved Febuary 8th, 2022. https://theconversation.com/not-all-calories-are-equal-a-dietitian-explains-the-different-ways-the-kinds-of-foods-you-eat-matter-to-your-body-156900
 
Stossel, John. 2006. “‘Super Size Me’ Carries Weight With Critics”. ABC News. Retrieved Febuary 8th, 2022. https://docs.google.com/document/d/1XB-22QylvnbasBKe7n_DfkkENcZWRvIR5X8vZgOK6LY/edit#

```{r include=FALSE}
library(tidyverse)
library(knitr)
library(broom)
library(cowplot)
library(patchwork)
library(leaps)
library(rms)
library(modelr)
```


# Our Data

```{r include = FALSE}
data <- read.csv("data/menu 2.csv")
glimpse(data)
```

# Exploratory Data Analysis

For this project, we understand that foods and beverages may have different predictors for their number of calories. Therefore, we will be splitting our dataset into two different dataframes: one for foods, and one for beverages.

We will also be removing all predictors that have "as % of Daily Value" attached at the end, since our purpose is not focused the daily values of the nutrients. These predictors add no value to our dataset or models.

The first thing we are doing is filtering out Total Fat (% Daily Value), Saturated Fat (% Daily Value), Cholesterol (% Daily Value), Sodium (% Daily Value), Carbohydrataes (% Daily Value), Dietary Fiber (% Daily Value) from our nutritional attributes. These attributes don’t aid to answering our research question, so we are taking these predictor variables out of consideration. 

```{r include = FALSE}
data <- data %>% 
  select(Category, Item, Serving.Size, Calories, Calories.from.Fat, Total.Fat,
         Saturated.Fat, Trans.Fat, Cholesterol, Sodium, Carbohydrates,
         Dietary.Fiber, Sugars, Protein, Vitamin.A....Daily.Value.,
         Vitamin.C....Daily.Value., Calcium....Daily.Value., Iron....Daily.Value.)

glimpse(data)
```

In order to accurately compare the estimators, we want to standardize them first. To do this, we make sure every estimator is centered around a mean of zero with a variance of one.

```{r echo = FALSE}
data <- data %>% 
  mutate(
    Total.Fat.cent = (Total.Fat - mean(Total.Fat)) / sd(Total.Fat),
    Saturated.Fat.cent = (Saturated.Fat - mean(Saturated.Fat)) / sd(Saturated.Fat),
    Trans.Fat.cent = (Trans.Fat - mean(Trans.Fat)) / sd(Trans.Fat),
    Cholesterol.cent = (Cholesterol - mean(Cholesterol)) / sd(Cholesterol),
    Sodium.cent = (Sodium - mean(Sodium)) / sd(Sodium),
    Carbohydrates.cent = (Carbohydrates - mean(Carbohydrates)) / sd(Carbohydrates),
    Dietary.Fiber.cent = (Dietary.Fiber - mean(Dietary.Fiber)) / sd(Dietary.Fiber),
    Sugars.cent = (Sugars - mean(Sugars)) / sd(Sugars),
    Protein.cent = (Protein - mean(Protein)) / sd(Protein),
    Vitamin.A....Daily.Value.cent = (Vitamin.A....Daily.Value. - mean(Vitamin.A....Daily.Value.)) / sd(Vitamin.A....Daily.Value.),
    Vitamin.C....Daily.Value.cent = (Vitamin.C....Daily.Value. - mean(Vitamin.C....Daily.Value.)) / sd(Vitamin.C....Daily.Value.),
    Calcium....Daily.Value.cent = (Calcium....Daily.Value. - mean(Calcium....Daily.Value.)) / sd(Calcium....Daily.Value.),
    Iron....Daily.Value.cent = (Iron....Daily.Value. - mean(Iron....Daily.Value.)) / sd(Iron....Daily.Value.),
  )

```

```{r include = FALSE}
count(data, Category)
```

Next, we are dividing our categorical variables between food items (Breakfast, Beef & Pork, Chicken & Fish, Salads, Snacks & Sides, Desserts) and drink items (Coffee and Tea, Smoothies and Shakes, Beverages).

```{r echo = FALSE}
food_data <- data %>% 
  filter(Category == "Beef & Pork" |
         Category == "Breakfast" |
         Category == "Chicken & Fish" |
         Category == "Desserts" |
         Category == "Salads" |
         Category == "Snacks & Sides")

bev_data <- data %>%
  filter(Category == "Beverages" |
         Category == "Coffee & Tea" |
         Category == "Smoothies & Shakes")
```
 
### Response Variable

The next step is to create histograms for occurences of food items (food_data) and occurences of drink items (bev_data) against our response variable (calories). Based on the plots below, it seems that for both datasets, the Calories variable follows a normal distribution.

```{r echo = FALSE, fig.width = 5, fig.height = 3}
p1 <- ggplot(data=food_data, aes(x=Calories)) +
  geom_histogram() +
  labs(title="Histogram of Response Variable for Food",
       x="Number of Calories",
       y="Number of Occurrences")

p2  <- ggplot(data=bev_data, aes(x=Calories)) +
  geom_histogram() +
  labs(title="Histogram of Response Variable for Beverages",
       x="Number of Calories",
       y="Number of Occurrences")

p1 + p2
```

Now we calculate the appropriate summary statistics for calories (mean, median, standard deviation, IQR) for food items and drink items.

```{r echo = FALSE}
food_data %>% 
  summarise(mean = mean(Calories),
            median = median(Calories),
            std_dev = sd(Calories),
            iqr = IQR(Calories))

bev_data %>% 
  summarise(mean = mean(Calories),
            median = median(Calories),
            std_dev = sd(Calories),
            iqr = IQR(Calories))
```

### Estimator Variables

We also want to view a plot of each variable's relationship with our response. Below is every plot that describes the food dataset.

```{r echo = FALSE, fig.width = 17, fig.height = 17}
p3 <- ggplot(data = food_data, aes(x = Calories, y = Total.Fat.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Total Fat")

p4 <- ggplot(data = food_data, aes(x = Calories, y = Saturated.Fat.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Saturated Fat")

p5 <- ggplot(data = food_data, aes(x = Calories, y = Trans.Fat.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Trans Fat")

p6 <- ggplot(data = food_data, aes(x = Calories, y = Cholesterol.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Cholesterol")

p7 <- ggplot(data = food_data, aes(x = Calories, y = Sodium.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Sodium")

p8 <- ggplot(data = food_data, aes(x = Calories, y = Carbohydrates.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Carbohydrates")

p9 <- ggplot(data = food_data, aes(x = Calories, y = Dietary.Fiber.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Dietary Fiber")

p10 <- ggplot(data = food_data, aes(x = Calories, y = Protein.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Protein")

p11 <- ggplot(data = food_data, aes(x = Calories, y = Sugars.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Sugars")

p12 <- ggplot(data = food_data, aes(x = Calories, y = Vitamin.A....Daily.Value.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Vitamin A")

p13 <- ggplot(data = food_data, aes(x = Calories, y = Vitamin.C....Daily.Value.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Vitamin C")

p14 <- ggplot(data = food_data, aes(x = Calories, y = Calcium....Daily.Value.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Calcium")

p15 <- ggplot(data = food_data, aes(x = Calories, y = Iron....Daily.Value.cent)) +
               geom_point() +
               labs(title = "FOOD: Calories vs. Iron")

p3 + p4 + p5 + p6 + p7 +  p8 + p9 + p10 + p11 + p12 + p13 + p14 + p15
```

Below is every plot that describes the beverage dataset.

```{r echo = FALSE, fig.width = 17, fig.height = 17}
p3 <- ggplot(data = bev_data, aes(x = Calories, y = Total.Fat.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Total Fat")

p4 <- ggplot(data = bev_data, aes(x = Calories, y = Saturated.Fat.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Saturated Fat")

p5 <- ggplot(data = bev_data, aes(x = Calories, y = Trans.Fat.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Trans Fat")

p6 <- ggplot(data = bev_data, aes(x = Calories, y = Cholesterol.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Cholesterol")

p7 <- ggplot(data = bev_data, aes(x = Calories, y = Sodium.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Sodium")

p8 <- ggplot(data = bev_data, aes(x = Calories, y = Carbohydrates.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Carbohydrates")

p9 <- ggplot(data = bev_data, aes(x = Calories, y = Dietary.Fiber.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Dietary Fiber")

p10 <- ggplot(data = bev_data, aes(x = Calories, y = Protein.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Protein")

p11 <- ggplot(data = bev_data, aes(x = Calories, y = Sugars.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Sugars")

p12 <- ggplot(data = bev_data, aes(x = Calories, y = Vitamin.A....Daily.Value.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Vitamin A")

p13 <- ggplot(data = bev_data, aes(x = Calories, y = Vitamin.C....Daily.Value.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Vitamin C")

p14 <- ggplot(data = bev_data, aes(x = Calories, y = Calcium....Daily.Value.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Calcium")

p15 <- ggplot(data = bev_data, aes(x = Calories, y = Iron....Daily.Value.cent)) +
               geom_point() +
               labs(title = "BEV: Calories vs. Iron")

p3 + p4 + p5 + p6 + p7 +  p8 + p9 + p10 + p11 + p12 + p13 + p14 + p15
```




### Model Selection with AIC

The code below creates a linear model for McDonalds food menu items and displays the model output.  

```{r echo = FALSE}
food_model = lm(Calories ~ Total.Fat + Saturated.Fat + Trans.Fat + Cholesterol + Sodium + Carbohydrates +
         Dietary.Fiber + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = food_data)

tidy(food_model) %>% 
  kable(format="markdown", digits = 3)
```

The code below creates a linear model for McDonald's drink menu items and displays the model output.

```{r echo = FALSE}
bev_model = lm(Calories ~ Total.Fat + Sodium + Carbohydrates + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = bev_data)

tidy(bev_model) %>% 
  kable(format="markdown", digits = 3)
```

Now, we will select a model for food items using AIC. We are using the step function in R to conduct backward selection using AIC as the selection criterion, and storing the selected model as food_model_select_aic. Finally, we display the coefficients of the selected model.  

```{r include = FALSE}
food_model_select_aic <- step(food_model, direction = "backward")
tidy(food_model_select_aic) %>% 
  kable(format="markdown", digits=3)

coef(food_model_select_aic, 4)
```
For food products, the predictors that give us the best model for predicting calorie count are:
  -Total.Fat
  -Saturated.Fat
  -Trans.Fat
  -Cholesterol
  -Sodium
  -Carbohydrates
  -Dietary.Fiber
  -Sugars
  -Protein
  -Vitamin.A….Daily.Value.
  -Vitamin.C….Daily.Value.
  -Calcium….Daily.Value.
  -Iron….Daily.Value.
  
Now, we will select a model for drink items using AIC. We are using the step function in R to conduct backward selection using AIC as the selection criterion, and storing the selected model as bev_model_select_aic. Finally, we display the coefficients of the selected model.

```{r include = FALSE}
bev_model_select_aic <- step(bev_model, direction = "backward")
tidy(bev_model_select_aic) %>% 
  kable(format="markdown", digits=3)

coef(bev_model_select_aic, 4)
```
For Beverages, the predictors that give us the best model for predicting calorie count are:
  -Total.Fat
  -Sodium
  -Carbohydrates
  -Sugars
  -Protein
  -Vitamin.A….Daily.Value.
  -Vitamin.C….Daily.Value.
  -Calcium….Daily.Value.
  -Iron….Daily.Value.


The code and its output below show us that the best predictors of food calories in order are Total Fat, Carbohydrates, and Protein.
```{r include = FALSE}
food_models <- regsubsets(Calories ~ Total.Fat + Saturated.Fat + Trans.Fat + Cholesterol + Sodium + Carbohydrates +
         Dietary.Fiber + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = food_data, method="backward")
summary(food_models)
```


The code and its output below show us that the best predictors of beverage calories in order are  Carbohydrates, Total Fat, and Protein
```{r include = FALSE}
bev_models <- regsubsets(Calories ~ Total.Fat + Saturated.Fat + Trans.Fat + Cholesterol + Sodium + Carbohydrates +
         Dietary.Fiber + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = bev_data, method="backward")
summary(bev_models)
```

When first starting the analysis we decided to divide our data between food and drink items on the assumption that they have different caloric makeups. We split our dataset between food menu items (Breakfast, Beef & Pork, Chicken & Fish, Salads, Snacks & Sides, Desserts) and drink menu items (Coffee and Tea, Smoothies and Shakes, Beverages). For food menu items, we hypothesized total carbohydrates (grams) was the most accurate predictor of calories. For drink menu items, we hypothesized that total sugar (grams) was the most accurate predictor of calories. Upon completing Exploratory Data Analysis, Regression, and Model Selection, our final models (food_model_aic and bev_model_aic) indicated that best 3 predictors (nutritional attributes) were the same for food and beverage items. We then decided it would be best for our final model to encompass food and beverage data together. Our modeling objective benefits from a bigger dataset, as predictions are more accurate when working with a bigger dataset.


A crucial assumption of linear regression is the independence of observations. Looking at how our data was collected will indicate if the independence assumption is satisfied or not. Given that our dataset consists of nutritional attributes for each McDonalds menu item, each observation is independent. A menu item’s observed nutritional attributes does not rely on other menu items. In part by FDA Menu Labeling Requirements (2020) the process by which our data was collected ensures data validity and that we are working with a random sample. 

References 
Food and Drug Administration. 2020. “Menu and Food Labeling Requirements”. 
https://www.fda.gov/food/food-labeling-nutrition/menu-labeling-requirements  


