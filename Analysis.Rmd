---
title: "Stat108_FinalProject"
author: "Dylan Scoble and Aisha Lakshman"
date: "2/4/2022"
output: pdf_document
---


# Introduction

In the 2004 documentary Super Size Me, writer and director Morgan Spurlock took on a month-long challenge to only eat McDonalds food. Spurlock experienced a multitude of health issues, including weight gain, cholesterol spike, and negative impacts on his energy and mood, demonstrating the fast-food chains’ instrumental role in America’s obesity epidemic (Stossel 2006). Spurlock’s film not only emphasized the consequences of caloric intake, but also brought light to the nutritional attributes of McDonalds menu items that caused adverse health effects. There are many factors that impact the quality and quantity of calories, such as levels of fat, protein, and carbohydrates, which is why many dieticians support the notion that  “not all calories are created equal” (Tolar-Peterson, 2021). Spurlock’s documentary and existing literature inspired an investigation of McDonalds menu items’ caloric and nutritional records. Our research will address the following question: What nutritional attribute is the best predictor of calories for the McDonalds menu items? Since drink and food items have quite different caloric makeups, we are dividing our dataset between food menu items (Breakfast, Beef & Pork, Chicken & Fish, Salads, Snacks & Sides, Desserts) and drink menu items (Coffee and Tea, Smoothies and Shakes, Beverages). For food menu items, we hypothesize total carbohydrates (grams) is the most accurate predictor of calories. For drink menu items, we hypothesize that total sugar (grams) is the most accurate predictor of calories We will analyze a 2018 dataset from Kaggle titled “Nutritional Facts for McDonald's Menu” to answer our research question. Our chosen dataset provides nutritional information for all of McDonald’s menu items, including calories, saturated fat, and cholesterol levels. We will create a linear model for each nutritional attribute with calories as the response variable for each predictor. A linear model for regression analysis is useful in answering our question because it will allow us to confidently determine what nutritional attributes matter the most for calories and predict an item’s calorie count based on its predictors.


### References

Tolar-Peterson, Terezie. 2021. “Not all calories are created equal - a dietician explains the different ways the kinds of foods you eat matter to your body”. The Conversation. Retrieved Febuary 8th, 2022. https://theconversation.com/not-all-calories-are-equal-a-dietitian-explains-the-different-ways-the-kinds-of-foods-you-eat-matter-to-your-body-156900
 
Stossel, John. 2006. “‘Super Size Me’ Carries Weight With Critics”. ABC News. Retrieved Febuary 8th, 2022. https://docs.google.com/document/d/1XB-22QylvnbasBKe7n_DfkkENcZWRvIR5X8vZgOK6LY/edit#

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(broom)
library(cowplot)
library(patchwork)
library(leaps)
library(rms)
```


# Our Data

```{r}
data <- read.csv("data/menu 2.csv")
glimpse(data)
```

# Exploratory Data Analysis

For this project, we understand that foods and beverages may have different predictors for their number of calories. Therefore, we will be splitting our dataset into two different dataframes: one for foods, and one for beverages.

We will also be removing all predictors that have "as % of Daily Value" attached at the end, since our purpose is not focused the daily values of the nutrients. These predictors add no value to our dataset or models.

The first thing we are doing is filtering out Total Fat (% Daily Value), Saturated Fat (% Daily Value), Cholesterol (% Daily Value), Sodium (% Daily Value), Carbohydrataes (% Daily Value), Dietary Fiber (% Daily Value) from our nutritional attributes. These attributes don’t aid to answering our research question, so we are taking these predictor variables out of consideration. 

```{r}
data <- data %>% 
  select(Category, Item, Serving.Size, Calories, Calories.from.Fat, Total.Fat,
         Saturated.Fat, Trans.Fat, Cholesterol, Sodium, Carbohydrates,
         Dietary.Fiber, Sugars, Protein, Vitamin.A....Daily.Value.,
         Vitamin.C....Daily.Value., Calcium....Daily.Value., Iron....Daily.Value.)

glimpse(data)
```


```{r}
count(data, Category)
```

Next, we are dividing our categorical variables between food items (Breakfast, Beef & Pork, Chicken & Fish, Salads, Snacks & Sides, Desserts) and drink items (Coffee and Tea, Smoothies and Shakes, Beverages).

```{r}
food_data <- data %>% 
  filter(Category == "Beef & Pork" |
         Category == "Breakfast" |
         Category == "Chicken & Fish" |
         Category == "Desserts" |
         Category == "Salads" |
         Category == "Snacks & Sides")

bev_data <- data %>%
  filter(Category == "Beverages" |
         Category == "Coffee & Tea" |
         Category == "Smoothies & Shakes")
```

 
### Response Variable

The next step is to create histograms for occurences of food items (food_data) and occurences of drink items (bev_data) against our response variable (calories) 

```{r}
ggplot(data=food_data, aes(x=Calories)) +
  geom_histogram() +
  labs(title="Histogram of Response Variable",
       x="Number of Calories",
       y="Number of Occurrences")

ggplot(data=bev_data, aes(x=Calories)) +
  geom_histogram() +
  labs(title="Histogram of Response Variable",
       x="Number of Calories",
       y="Number of Occurrences")
```

Now we calculate the appropriate summary statistics for calories (mean, median, standard deviation, IQR) for food items and drink items.

```{r}
food_data %>% 
  summarise(mean = mean(Calories),
            median = median(Calories),
            std_dev = sd(Calories),
            iqr = IQR(Calories))

bev_data %>% 
  summarise(mean = mean(Calories),
            median = median(Calories),
            std_dev = sd(Calories),
            iqr = IQR(Calories))
```

# Regression

The code below creates a linear model for McDonald's food menu items and displays the model output.  

```{r}
food_model = lm(Calories ~ Total.Fat + Saturated.Fat + Trans.Fat + Cholesterol + Sodium + Carbohydrates +
         Dietary.Fiber + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = food_data)

tidy(food_model, conf.int = TRUE) %>% 
  kable(format="markdown", digits = 5)
```

The code below creates a linear model for McDonald's drink menu items and displays the model output.

```{r}
bev_model = lm(Calories ~ Total.Fat + Sodium + Carbohydrates + Sugars + Protein + Vitamin.A....Daily.Value. +
         Vitamin.C....Daily.Value. + Calcium....Daily.Value. + Iron....Daily.Value., data = bev_data)

tidy(bev_model, conf.int = TRUE) %>% 
  kable(format="markdown", digits = 5)
```

Now, we will select a model for food items using AIC. We are using the step function in R to conduct backward selection using AIC as the selection criterion, and storing the selected model as food_model_select_aic. Finally, we display the coefficients of the selected model.  

```{r}
food_model_select_aic <- step(food_model, direction = "backward")
tidy(food_model_select_aic) %>% 
  kable(format="markdown", digits=3)
```
For food products, the predictors that give us the best model for predicting calorie count are:
  -Total.Fat
  -Saturated.Fat
  -Trans.Fat
  -Cholesterol
  -Sodium
  -Carbohydrates
  -Dietary.Fiber
  -Sugars
  -Protein
  -Vitamin.A….Daily.Value.
  -Vitamin.C….Daily.Value.
  -Calcium….Daily.Value.
  -Iron….Daily.Value.
  
Now, we will select a model for drink items using AIC. We are using the step function in R to conduct backward selection using AIC as the selection criterion, and storing the selected model as bev_model_select_aic. Finally, we display the coefficients of the selected model.

```{r}
bev_model_select_aic <- step(bev_model, direction = "backward")
tidy(bev_model_select_aic) %>% 
  kable(format="markdown", digits=3)
```
For Beverages, the predictors that give us the best model for predicting calorie count are:
  -Total.Fat
  -Sodium
  -Carbohydrates
  -Sugars
  -Protein
  -Vitamin.A….Daily.Value.
  -Vitamin.C….Daily.Value.
  -Calcium….Daily.Value.
  -Iron….Daily.Value.
